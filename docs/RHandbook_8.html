<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Emily Schultz" />

<meta name="date" content="2025-03-24" />

<title>ESS 3500 R Handbook, Lesson 8</title>

<script src="site_libs/header-attrs-2.30/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.5.16/iframeResizer.min.js" type="text/javascript"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ESS 3500 R Handbook</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lessons
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="RHandbook_1.html">Lesson 1: Software installation</a>
    </li>
    <li>
      <a href="RHandbook_2.html">Lesson 2: Data management</a>
    </li>
    <li>
      <a href="RHandbook_3.html">Lesson 3: R basics</a>
    </li>
    <li>
      <a href="RHandbook_4.html">Lesson 4: Data frames</a>
    </li>
    <li>
      <a href="RHandbook_5.html">Lesson 5: Data visualization</a>
    </li>
    <li>
      <a href="RHandbook_6.html">Lesson 6: Graphing in R</a>
    </li>
    <li>
      <a href="RHandbook_7.html">Lesson 7: Hypothesis testing</a>
    </li>
    <li>
      <a href="RHandbook_8.html">Lesson 8: Probability</a>
    </li>
    <li>
      <a href="RHandbook_9.html">Lesson 9: Probability distributions</a>
    </li>
    <li>
      <a href="RHandbook_10.html">Lesson 10: Chi-square tests</a>
    </li>
    <li>
      <a href="RHandbook_11.html">Lesson 11: T-tests</a>
    </li>
    <li>
      <a href="RHandbook_12.html">Lesson 12: Assumptions and transformations</a>
    </li>
    <li>
      <a href="RHandbook_13.html">Lesson 13: ANOVA</a>
    </li>
    <li>
      <a href="RHandbook_14.html">Lesson 14: Correlations and Regressions</a>
    </li>
    <li>
      <a href="RHandbook_15.html">Lesson 15: Multiple predictors</a>
    </li>
  </ul>
</li>
<li>
  <a href="RHandbook_templates.html">R Templates</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">ESS 3500 R Handbook, Lesson 8</h1>
<h4 class="author">Emily Schultz</h4>
<h4 class="date">2025-03-24</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#lesson-8-probability" id="toc-lesson-8-probability">Lesson
8: Probability</a>
<ul>
<li><a href="#lession-8.1-probility-basics"
id="toc-lession-8.1-probility-basics">Lession 8.1 Probility Basics</a>
<ul>
<li><a href="#basic-laws-of-probability"
id="toc-basic-laws-of-probability">Basic laws of probability</a></li>
<li><a href="#probabilties-of-multiple-events"
id="toc-probabilties-of-multiple-events">Probabilties of multiple
events</a></li>
<li><a href="#exercises-applications-in-ecology-and-evolution"
id="toc-exercises-applications-in-ecology-and-evolution">Exercises:
Applications in ecology and evolution</a></li>
</ul></li>
<li><a href="#lession-8.2-probility---beyond-the-basics"
id="toc-lession-8.2-probility---beyond-the-basics">Lession 8.2 Probility
- Beyond the Basics</a></li>
</ul></li>
</ul>
</div>

<div id="lesson-8-probability" class="section level1">
<h1>Lesson 8: Probability</h1>
<div id="lession-8.1-probility-basics" class="section level2">
<h2>Lession 8.1 Probility Basics</h2>
<p>Probability is a field of mathematics that is used for the study of
random events. It allows us to quantify the likelihood of particular
outcomes. In scientific research, when we sample from a population, the
act of sampling is a random event. When we analyze data, we use
probability to help us draw conclusions based on the particular outcome
we observe in our data.</p>
<div id="basic-laws-of-probability" class="section level3">
<h3>Basic laws of probability</h3>
<p>The probability of an event is defined as the likelihood that
particular event occurs. In order to calculate the probability, we have
to define the event and the sample space:</p>
<ul>
<li><p><strong>Event</strong>: A specific outcome or set of
outcomes</p></li>
<li><p><strong>Sample space</strong>: The full set of possible
outcomes</p></li>
</ul>
<p>We can then calculate the probability by dividing the number of
favorable outcomes (the number of outcomes that match the criteria
defined by our event) by the total number of possible outcomes.</p>
<p><span class="math display">\[
P(\text{Event}) = \frac{\text{Number of favorable outcomes}}{\text{Total
number of possible outcomes}}
\]</span> In this equation, <span
class="math inline">\(P(\text{Event})\)</span> is shorthand for the
probability of the event.</p>
<p>If we know the probability of an event and the total number of
possible outcomes, we can also flip this equation around to calculate
the number of favorable outcomes:</p>
<p><span class="math display">\[
\text{Number of favorable outcomes} = \text{Total number of possible
outcomes} \times P(\text{Event})
\]</span> The formula for calculating probability leads to some useful
rules that can help us understand and calculate probabilities:</p>
<ol style="list-style-type: decimal">
<li>The values of probabilities are between 0 and 1.</li>
<li>The probability of an impossible event is 0.</li>
<li>The probability of a certain event is 1.</li>
<li>The sum of the probabilities for all possible events is 1</li>
<li>The probability that an event does not happen is 1 minus the
probability that the event does happen. (This follows from rule 4
because an event happening and an event not happening represent all
possible outcome, so the probabilities of the two must add to one.)</li>
</ol>
<p>Now let’s look at some examples of how we can use these equations for
calculating probabilities:</p>
<div id="example-1" class="section level4">
<h4>Example 1</h4>
<p>A plant community has 50 individuals of species 1, 40 individuals of
species 2, 20 individuals of species 3, and 10 individuals of species 4.
If we randomly select an individual from the population, what is the
probability that individual is species 3?</p>
<p>Let’s start by identifying our event and sample space:</p>
<p>Event: Selecting an individual of species 3. There are 20 favorable
outcomes because there are 20 individuals of species 3. Sample space:
The total number of individuals in the community</p>
<p>Then we’ll calculate our probability:</p>
<p><span class="math display">\[
P(\text{Species 3}) = \frac{30}{50 + 40 + 20 + 10} = \frac{30}{120} =
0.25
\]</span></p>
</div>
<div id="example-2" class="section level4">
<h4>Example 2</h4>
<p><em>Staphylococcus aureus</em> is a bacteria species that can cause
disease in humans, and it is known for high levels of antibiotic
resistance. It is estimated that the rate of Penicillin G resistance in
<em>Staphylococcus aureus</em> is 80%, or <span
class="math inline">\(\frac{4}{5}\)</span>. If there are 120,000
patients with bloodstream infections from <em>Staphylococcus
aureus</em>, how many of those patients would be expected to have strain
that is resistant to Penicillin G?</p>
<p>For this one, we are given the probability of Penicillin G resistance
(<span class="math inline">\(\frac{4}{5}\)</span>) and the total number
of outcomes (120,000), so we can work backwards to calculate the number
of “favorable events” (i.e., number of patients with a resistant
strain).</p>
<p><span class="math display">\[
\text{Number resistant} = 120000 \times \frac{4}{5} = 96000
\]</span></p>
</div>
<div id="example-3" class="section level4">
<h4>Example 3</h4>
<p>Wetland-associated frog species in the United States have a <span
class="math inline">\(\frac{2}{5}\)</span> chance of being infected with
chytrid fungus. What is the probability that a wetland-associated frog
is not infected with chytrid?</p>
<p>To answer this, we can use the law of probability that states that
the probability that an event does not happen is 1 minus the probability
that the event does happen:</p>
<p><span class="math display">\[
P(\text{Uninfected}) = 1 - P(\text{Infected}) = 1 - \frac{2}{5} =
\frac{3}{5}
\]</span></p>
</div>
</div>
<div id="probabilties-of-multiple-events" class="section level3">
<h3>Probabilties of multiple events</h3>
<p>In the section above, we calculated the probability of single events.
However, often we want to know the probability of multiple events. In
this section we will cover rules for combining together the
probabilities of multiple events. There are two general types of
questions that involve combining together probabilities for multiple
events:</p>
<ol style="list-style-type: decimal">
<li>What is the probability that two or more events both/all happen?
(What is the probability of event A and B both happening?)</li>
<li>What is the probability of one event or another event(s) happening?
(What is the probability that event A or event B happens?)</li>
</ol>
<p>To combine together probabilities in this way, we use the
multiplication and addition rules, respectively. To help me remember
which is which, I try to remember the relationship between the key words
in the question and the rule I need to use:</p>
<ul>
<li><strong>BOTH</strong>/<strong>AND</strong> = Multiplication
rule</li>
<li><strong>EITHER</strong>/<strong>OR</strong> = Addition rule</li>
</ul>
<p>For this section, we will assume that the events we are considering
are independent. In other words, the outcome of one event does not
influence the probability of the outcome of the other event(s).</p>
<div id="multiplication-rule" class="section level4">
<h4>Multiplication rule</h4>
<p>If we want to know the probability that two events, lets call them
events A and B, both happen (i.e., event A <strong>AND</strong> event B
happen), we use the multiplication rule. We simply multiply together the
probabilities of event A and event B to get the probability that event A
and B both happen:</p>
<p><span class="math display">\[
P(\text{A and B}) = P(\text{A}) \times P(\text{B})
\]</span> For example, if we roll two dice, and we want to know the
probability of rolling a 6 on both dice, we would calculate that as
follows:</p>
<p><span class="math display">\[
P(6 \text{ and } 6) = \frac{1}{6} \times \frac{1}{6} = \frac{1}{36}
\]</span></p>
</div>
<div id="addition-rule" class="section level4">
<h4>Addition rule</h4>
<p>If we want to know the probability that one event <strong>OR</strong>
another event happens, we use the addition rule. We add together the
probabilities of the individual events to get the probability that
either one of the events happens.</p>
<p><span class="math display">\[
P(\text{A or B}) = P(\text{A}) + P(\text{B})
\]</span> For example, if we roll a die and want to know the probability
of rolling an even number (2, 4, or 6), we would calculate that by
adding together the probabilities of each one of those possible
outcomes:</p>
<p><span class="math display">\[
P(2, 4, \text{ or } 6) = \frac{1}{6} + \frac{1}{6} + \frac{1}{6} =
\frac{3}{6} = \frac{1}{2}
\]</span> This version of the addition rule only works for events that
are mutually exclusive, meaning that if one event happens, the other(s)
cannot. This is true in the example we used of rolling the die. If we
roll a single die once, and get a 2, that means we can’t also get a 4 or
6. If two events are not mutually exclusive (they can both happen at the
same time), then we have to use an alternative version of the addition
rule to account for that.</p>
</div>
<div id="addition-rule-for-non-mutually-exclusive-events"
class="section level4">
<h4>Addition rule for non-mutually exclusive events</h4>
<p>When we have non-mutually-exclusive events, which can both happen at
the same time, if we use the addition rule above to estimate the
probability that either of the events happens, we will over-estimate the
probability. This is because the addition rule will essentially
double-count the probability of both events happening. This is easier to
understand if we look at a visual representation of the probability of
the events.</p>
<p>In the diagram below, the outer rectangle represents the sample
space, or the full set of possible outcomes. The area of the blue circle
represents the probability that event A happens, and the area orange
circle represents the probability that event B happens. The area of
overlap between the two is the probability that both events happen.</p>
<p><img src="NonMutuallyExclusive.png" style="width:60.0%"
alt="A rectangle containing two overlapping cirlces labeled A and B" />
<br></p>
<p>To calculate the probability that either event A or event B happens,
we want to calculate the area that is surrounded by the black outline
around the two circles. If we do that by adding together the total area
of both circles, the area of overlap in the middle will be counted
twice, but to accurately calculate the area, we only want to count it
once.</p>
<p>We can account for this by adapting our addition formula to subtract
out that area of overlap. In other words, we have to subtract out the
probability of A and B both happening. This takes us back to the
multiplication rule. To calculate the probability of both A and B
happening, we multiply the two probabilities together, so that is the
value we need to subtract from the addition rule:</p>
<p><span class="math display">\[
P(\text{A or B}) = P(\text{A}) + P(\text{B}) - P(\text{A})P(\text{B})
\]</span> Here’s an example of how this works. Say we are interested in
the prevalence of parasites in a population of elk. There are two common
parasites in the population: tapeworm cysts (<em>Taenia krabbei</em>)
and brainworm nematodes (<em>Parelaphostrongylus tenuis</em>). You know
the frequency of tapeworms is 0.3 and the frequency of brainworm 2 is
0.4, and it is possible for a single individual to be infected with both
parasites at the same time (i.e., infection by the two parasites is not
mutually-exclusive). You want to know the probability that an individual
in the population is infected with at least one of the parasites. We can
do that using the modified addition equation for non-mutually exclusive
events, as shown below (T = tapeworm, B = brainworm):</p>
<p><span class="math display">\[
P(\text{T or B}) = P(\text{T}) + P(\text{B}) - P(\text{T})P(\text{B})
\]</span> <span class="math display">\[
P(\text{T or B}) = 0.3 + 0.4 - (0.3\times0.4) = 0.58
\]</span> Therefore, the probability of an individual being infected
with at least one of the parasites is 0.58. Had we used the addition
rule for mutually-exclusive events, we would have incorrectly estimated
the probability to be 0.7.</p>
</div>
</div>
<div id="exercises-applications-in-ecology-and-evolution"
class="section level3">
<h3>Exercises: Applications in ecology and evolution</h3>
<!---LEARNR EX 1-7-->
<iframe style="margin:0 auto; min-width: 100%;" id="myIframeL3" class="interactive" src="https://rby8g8-emily-schultz.shinyapps.io/RHandbookL8/
" scrolling="no" frameborder="no">
</iframe>
<!---------------->
</div>
</div>
<div id="lession-8.2-probility---beyond-the-basics"
class="section level2">
<h2>Lession 8.2 Probility - Beyond the Basics</h2>
<script>
  iFrameResize({}, ".interactive");
</script>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
