<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Emily Schultz" />

<meta name="date" content="2025-03-24" />

<title>ESS 3500 R Handbook, Lesson 8</title>

<script src="site_libs/header-attrs-2.30/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.5.16/iframeResizer.min.js" type="text/javascript"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ESS 3500 R Handbook</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lessons
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="RHandbook_1.html">Lesson 1: Software installation</a>
    </li>
    <li>
      <a href="RHandbook_2.html">Lesson 2: Data management</a>
    </li>
    <li>
      <a href="RHandbook_3.html">Lesson 3: R basics</a>
    </li>
    <li>
      <a href="RHandbook_4.html">Lesson 4: Data frames</a>
    </li>
    <li>
      <a href="RHandbook_5.html">Lesson 5: Data visualization</a>
    </li>
    <li>
      <a href="RHandbook_6.html">Lesson 6: Graphing in R</a>
    </li>
    <li>
      <a href="RHandbook_7.html">Lesson 7: Hypothesis testing</a>
    </li>
    <li>
      <a href="RHandbook_8.html">Lesson 8: Probability</a>
    </li>
    <li>
      <a href="RHandbook_9.html">Lesson 9: Probability distributions</a>
    </li>
    <li>
      <a href="RHandbook_10.html">Lesson 10: Chi-square tests</a>
    </li>
    <li>
      <a href="RHandbook_11.html">Lesson 11: T-tests</a>
    </li>
    <li>
      <a href="RHandbook_12.html">Lesson 12: Assumptions and transformations</a>
    </li>
    <li>
      <a href="RHandbook_13.html">Lesson 13: ANOVA</a>
    </li>
    <li>
      <a href="RHandbook_14.html">Lesson 14: Correlations and Regressions</a>
    </li>
    <li>
      <a href="RHandbook_15.html">Lesson 15: Multiple predictors</a>
    </li>
  </ul>
</li>
<li>
  <a href="RHandbook_templates.html">R Templates</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">ESS 3500 R Handbook, Lesson 8</h1>
<h4 class="author">Emily Schultz</h4>
<h4 class="date">2025-03-24</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#lesson-8-probability" id="toc-lesson-8-probability">Lesson
8: Probability</a>
<ul>
<li><a href="#lession-8.1-probility-basics"
id="toc-lession-8.1-probility-basics">Lession 8.1 Probility Basics</a>
<ul>
<li><a href="#basic-laws-of-probability"
id="toc-basic-laws-of-probability">Basic laws of probability</a></li>
<li><a href="#probabilties-of-multiple-events"
id="toc-probabilties-of-multiple-events">Probabilties of multiple
events</a></li>
<li><a href="#exercises-applications-in-ecology-and-evolution"
id="toc-exercises-applications-in-ecology-and-evolution">Exercises:
Applications in ecology and evolution</a></li>
</ul></li>
<li><a href="#lession-8.2-advanced-probability"
id="toc-lession-8.2-advanced-probability">Lession 8.2 Advanced
Probability</a>
<ul>
<li><a href="#conditional-probability"
id="toc-conditional-probability">Conditional probability</a></li>
<li><a href="#binomial-theorem" id="toc-binomial-theorem">Binomial
Theorem</a></li>
<li><a
href="#exercises-conditional-probability-and-binomial-theorem-in-ecology"
id="toc-exercises-conditional-probability-and-binomial-theorem-in-ecology">Exercises:
Conditional Probability and Binomial Theorem in Ecology</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<div id="lesson-8-probability" class="section level1">
<h1>Lesson 8: Probability</h1>
<div id="lession-8.1-probility-basics" class="section level2">
<h2>Lession 8.1 Probility Basics</h2>
<p>Probability is a field of mathematics that is used for the study of
random events. It allows us to quantify the likelihood of particular
outcomes. In scientific research, when we sample from a population, the
act of sampling is a random event. When we analyze data, we use
probability to help us draw conclusions based on the particular outcome
we observe in our data.</p>
<div id="basic-laws-of-probability" class="section level3">
<h3>Basic laws of probability</h3>
<p>The probability of an event is defined as the likelihood that
particular event occurs. In order to calculate the probability, we have
to define the event and the sample space:</p>
<ul>
<li><p><strong>Event</strong>: A specific outcome or set of
outcomes</p></li>
<li><p><strong>Sample space</strong>: The full set of possible
outcomes</p></li>
</ul>
<p>We can then calculate the probability by dividing the number of
favorable outcomes (the number of outcomes that match the criteria
defined by our event) by the total number of possible outcomes.</p>
<p><span class="math display">\[
P(\text{Event}) = \frac{\text{Number of favorable outcomes}}{\text{Total
number of possible outcomes}}
\]</span> In this equation, <span
class="math inline">\(P(\text{Event})\)</span> is shorthand for the
probability of the event.</p>
<p>If we know the probability of an event and the total number of
possible outcomes, we can also flip this equation around to calculate
the number of favorable outcomes:</p>
<p><span class="math display">\[
\text{Number of favorable outcomes} = \text{Total number of possible
outcomes} \times P(\text{Event})
\]</span> The formula for calculating probability leads to some useful
rules that can help us understand and calculate probabilities:</p>
<ol style="list-style-type: decimal">
<li>The values of probabilities are between 0 and 1.</li>
<li>The probability of an impossible event is 0.</li>
<li>The probability of a certain event is 1.</li>
<li>The sum of the probabilities for all possible events is 1</li>
<li>The probability that an event does not happen is 1 minus the
probability that the event does happen. (This follows from rule 4
because an event happening and an event not happening represent all
possible outcome, so the probabilities of the two must add to one.)</li>
</ol>
<p>Now let‚Äôs look at some examples of how we can use these equations for
calculating probabilities:</p>
<div id="example-1" class="section level4">
<h4>Example 1</h4>
<p>A plant community has 50 individuals of species 1, 40 individuals of
species 2, 20 individuals of species 3, and 10 individuals of species 4.
If we randomly select an individual from the population, what is the
probability that individual is species 3?</p>
<p>Let‚Äôs start by identifying our event and sample space:</p>
<p>Event: Selecting an individual of species 3. There are 20 favorable
outcomes because there are 20 individuals of species 3. Sample space:
The total number of individuals in the community</p>
<p>Then we‚Äôll calculate our probability:</p>
<p><span class="math display">\[
P(\text{Species 3}) = \frac{30}{50 + 40 + 20 + 10} = \frac{30}{120} =
0.25
\]</span></p>
</div>
<div id="example-2" class="section level4">
<h4>Example 2</h4>
<p><em>Staphylococcus aureus</em> is a bacteria species that can cause
disease in humans, and it is known for high levels of antibiotic
resistance. It is estimated that the rate of Penicillin G resistance in
<em>Staphylococcus aureus</em> is 80%, or <span
class="math inline">\(\frac{4}{5}\)</span>. If there are 120,000
patients with bloodstream infections from <em>Staphylococcus
aureus</em>, how many of those patients would be expected to have strain
that is resistant to Penicillin G?</p>
<p>For this one, we are given the probability of Penicillin G resistance
(<span class="math inline">\(\frac{4}{5}\)</span>) and the total number
of outcomes (120,000), so we can work backwards to calculate the number
of ‚Äúfavorable events‚Äù (i.e., number of patients with a resistant
strain).</p>
<p><span class="math display">\[
\text{Number resistant} = 120000 \times \frac{4}{5} = 96000
\]</span></p>
</div>
<div id="example-3" class="section level4">
<h4>Example 3</h4>
<p>Wetland-associated frog species in the United States have a <span
class="math inline">\(\frac{2}{5}\)</span> chance of being infected with
chytrid fungus. What is the probability that a wetland-associated frog
is not infected with chytrid?</p>
<p>To answer this, we can use the law of probability that states that
the probability that an event does not happen is 1 minus the probability
that the event does happen:</p>
<p><span class="math display">\[
P(\text{Uninfected}) = 1 - P(\text{Infected}) = 1 - \frac{2}{5} =
\frac{3}{5}
\]</span></p>
</div>
</div>
<div id="probabilties-of-multiple-events" class="section level3">
<h3>Probabilties of multiple events</h3>
<p>In the section above, we calculated the probability of single events.
However, often we want to know the probability of multiple events. In
this section we will cover rules for combining together the
probabilities of multiple events. There are two general types of
questions that involve combining together probabilities for multiple
events:</p>
<ol style="list-style-type: decimal">
<li>What is the probability that two or more events both/all happen?
(What is the probability of event A and B both happening?)</li>
<li>What is the probability of one event or another event(s) happening?
(What is the probability that event A or event B happens?)</li>
</ol>
<p>To combine together probabilities in this way, we use the
multiplication and addition rules, respectively. To help me remember
which is which, I try to remember the relationship between the key words
in the question and the rule I need to use:</p>
<ul>
<li><strong>BOTH</strong>/<strong>AND</strong> = Multiplication
rule</li>
<li><strong>EITHER</strong>/<strong>OR</strong> = Addition rule</li>
</ul>
<p>For this section, we will assume that the events we are considering
are independent. In other words, the outcome of one event does not
influence the probability of the outcome of the other event(s).</p>
<div id="multiplication-rule" class="section level4">
<h4>Multiplication rule</h4>
<p>If we want to know the probability that two events, lets call them
events A and B, both happen (i.e., event A <strong>AND</strong> event B
happen), we use the multiplication rule. We simply multiply together the
probabilities of event A and event B to get the probability that event A
and B both happen:</p>
<p><span class="math display">\[
P(\text{A and B}) = P(\text{A}) \times P(\text{B})
\]</span> For example, if we roll two dice, and we want to know the
probability of rolling a 6 on both dice, we would calculate that as
follows:</p>
<p><span class="math display">\[
P(6 \text{ and } 6) = \frac{1}{6} \times \frac{1}{6} = \frac{1}{36}
\]</span></p>
</div>
<div id="addition-rule" class="section level4">
<h4>Addition rule</h4>
<p>If we want to know the probability that one event <strong>OR</strong>
another event happens, we use the addition rule. We add together the
probabilities of the individual events to get the probability that
either one of the events happens.</p>
<p><span class="math display">\[
P(\text{A or B}) = P(\text{A}) + P(\text{B})
\]</span> For example, if we roll a die and want to know the probability
of rolling an even number (2, 4, or 6), we would calculate that by
adding together the probabilities of each one of those possible
outcomes:</p>
<p><span class="math display">\[
P(2, 4, \text{ or } 6) = \frac{1}{6} + \frac{1}{6} + \frac{1}{6} =
\frac{3}{6} = \frac{1}{2}
\]</span> This version of the addition rule only works for events that
are mutually exclusive, meaning that if one event happens, the other(s)
cannot. This is true in the example we used of rolling the die. If we
roll a single die once, and get a 2, that means we can‚Äôt also get a 4 or
6. If two events are not mutually exclusive (they can both happen at the
same time), then we have to use an alternative version of the addition
rule to account for that.</p>
</div>
<div id="addition-rule-for-non-mutually-exclusive-events"
class="section level4">
<h4>Addition rule for non-mutually exclusive events</h4>
<p>When we have non-mutually-exclusive events, which can both happen at
the same time, if we use the addition rule above to estimate the
probability that either of the events happens, we will over-estimate the
probability. This is because the addition rule will essentially
double-count the probability of both events happening. This is easier to
understand if we look at a visual representation of the probability of
the events.</p>
<p>In the diagram below, the outer rectangle represents the sample
space, or the full set of possible outcomes. The area of the blue circle
represents the probability that event A happens, and the area orange
circle represents the probability that event B happens. The area of
overlap between the two is the probability that both events happen.</p>
<p><img src="NonMutuallyExclusive.png" style="width:60.0%"
alt="A rectangle containing two overlapping cirlces labeled A and B" />
<br></p>
<p>To calculate the probability that either event A or event B happens,
we want to calculate the area that is surrounded by the black outline
around the two circles. If we do that by adding together the total area
of both circles, the area of overlap in the middle will be counted
twice, but to accurately calculate the area, we only want to count it
once.</p>
<p>We can account for this by adapting our addition formula to subtract
out that area of overlap. In other words, we have to subtract out the
probability of A and B both happening. This takes us back to the
multiplication rule. To calculate the probability of both A and B
happening, we multiply the two probabilities together, so that is the
value we need to subtract from the addition rule:</p>
<p><span class="math display">\[
P(\text{A or B}) = P(\text{A}) + P(\text{B}) - P(\text{A})P(\text{B})
\]</span> Here‚Äôs an example of how this works. Say we are interested in
the prevalence of parasites in a population of elk. There are two common
parasites in the population: tapeworm cysts (<em>Taenia krabbei</em>)
and brainworm nematodes (<em>Parelaphostrongylus tenuis</em>). You know
the frequency of tapeworms is 0.3 and the frequency of brainworm 2 is
0.4, and it is possible for a single individual to be infected with both
parasites at the same time (i.e., infection by the two parasites is not
mutually-exclusive). You want to know the probability that an individual
in the population is infected with at least one of the parasites. We can
do that using the modified addition equation for non-mutually exclusive
events, as shown below (T = tapeworm, B = brainworm):</p>
<p><span class="math display">\[
P(\text{T or B}) = P(\text{T}) + P(\text{B}) - P(\text{T})P(\text{B})
\]</span> <span class="math display">\[
P(\text{T or B}) = 0.3 + 0.4 - (0.3\times0.4) = 0.58
\]</span> Therefore, the probability of an individual being infected
with at least one of the parasites is 0.58. Had we used the addition
rule for mutually-exclusive events, we would have incorrectly estimated
the probability to be 0.7.</p>
</div>
</div>
<div id="exercises-applications-in-ecology-and-evolution"
class="section level3">
<h3>Exercises: Applications in ecology and evolution</h3>
<!---LEARNR EX 1-3-->
<iframe style="margin:0 auto; min-width: 100%;" id="myIframeL3" class="interactive" src="https://rby8g8-emily-schultz.shinyapps.io/RHandbookL8/
" scrolling="no" frameborder="no">
</iframe>
<!---------------->
</div>
</div>
<div id="lession-8.2-advanced-probability" class="section level2">
<h2>Lession 8.2 Advanced Probability</h2>
<div id="conditional-probability" class="section level3">
<h3>Conditional probability</h3>
<p>In the probability examples we considered above, when we calculated
the probability of multiple events, we assumed those events were
independent - the outcome of one event did not influence the probability
of the other outcome(s). However, often this is not true. In many cases,
a particular event or condition does affect the probability of another
event. We refer to this as conditional probability: the probability of
one event is conditioned on another.</p>
<p>We actually worked with conditional probability when we discussed
hypothesis testing. When we looked at the probabilities of observing a
particular outcome in our data, we calculated those probabilities based
on a particular hypothesis, or condition.</p>
<p>In this section, we will learn how to calculate conditional
probabilities.</p>
<p>We‚Äôll start with an example (you might remember this from the
probability questions we went through on the first day of class):</p>
<p>Approximately 1% of women aged 40-50 have breast cancer. A woman with
breast cancer has a 90% chance of a positive test from a mammogram,
while a woman without has a 10% chance of a false positive result. What
is the probability a woman in the 40-50 age range has breast cancer
given that she just had a positive test?</p>
<p>This is a conditional probability question because we want to know
the probability that a woman has breast cancer, based on a particular
set of conditions: she is in the 40-50 age range and she just had a
positive test result.</p>
<p>We‚Äôll go through three methods for solving this. All of them with
lead to the same answer, so when you solve problems like this you can
work with the method that makes the most sense to you.</p>
<div id="option-1-diagram" class="section level4">
<h4>Option 1: Diagram</h4>
<p>Let‚Äôs start out with a visual that shows the possible scenarios and
their probabilities:</p>
<p><img src="conditionalprob.png" style="width:60.0%"
alt="A diagram showing the percent of 40-50-year-old women who do and do not have breast cancer (1% and 99%, respectively) and the percent of positive and negative test results for each group (10% positive and 90% negative for women without cancer, and 90% positive and 10% negative for women with cancer.)" />
<br></p>
<p>This diagram summarizes the information in the question regarding the
percent of women with and without cancer and their respective percent
chances of getting a positive and negative mammogram result. We could
solve the problem with just these percentages, but is easier to work
with number of individuals than percentages.</p>
<p>Let‚Äôs assume we start with a group of 1000 women (we could choose any
number of women, but 1000 is a nice round number that will allow us to
work with whole numbers instead of fractions.) If we have 1000 women in
this group, and 1% are expected to have cancer, we would expect 990 of
those women not to have cancer and 10 of those women to not have cancer.
Each of those groups now have a different probability of a positive test
result. Women without cancer have a 10% chance of a false positive, so
we would expect 99 of the cancer-free women to get a positive result,
while 891 would get a negative result. Women with cancer have a 90%
chance of a true positive, so we would expect 9 of the 10 to get a
positive result and 1 to get a negative result. These numbers are
summarized in the diagram below.</p>
<div class="float">
<img src="conditionalnum.png" style="width:60.0%"
alt="A diagram showing the number out of 1000 40-50-year-old women who do and do not have breast cancer (10 and 990, respectively) and the number of positive and negative test results for each group (99 positive and 891 negative for women without cancer, and 9 positive and 1 negative for women with cancer.)" />
<div class="figcaption">A diagram showing the number out of 1000
40-50-year-old women who do and do not have breast cancer (10 and 990,
respectively) and the number of positive and negative test results for
each group (99 positive and 891 negative for women without cancer, and 9
positive and 1 negative for women with cancer.)</div>
</div>
<p><br></p>
<p>Now that we have the number of women in each group who would get
positive and negative test results, it is easier to calculate the
probability that a woman has cancer if she got a positive result. We
just have to identify the number of women who got a positive test result
and actually have cancer (9) and the total number of women who got a
positive result (9 women who have cancer and got a positive result + 99
women who do not have cancer and have a positive test result = 108 total
positive tests). Now we can calculate our probability:</p>
<p><span class="math display">\[
P(\text{Cancer|Positive}) = \frac{9}{108} = 0.083,
\]</span> where <span
class="math inline">\(P(\text{Cancer|Positive})\)</span> is the
probability of cancer given a positive test result.</p>
</div>
<div id="option-2-table" class="section level4">
<h4>Option 2: Table</h4>
<p>For our second strategy, we will put together a table representing
all of the probabilities for our scenario: cancer or no cancer and
positive test or negative test. We will fill in the table with the
probabilities for each of those combinations (using the multiplication
rule!). For example, in the upper left hand corner in the table below,
we calculate the probability of a woman having cancer and getting a
positive test result, so we multiply together the probability of having
cancer and the probability of a positive test results if a woman does
have cancer.</p>
<style type="text/css">
.table {
  width: 80%;
}
</style>
<table>
<colgroup>
<col width="30%" />
<col width="38%" />
<col width="30%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Cancer (1%)</th>
<th align="right">No cancer (99%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Positive</td>
<td align="center">True positive: 0.01 x 0.9 = 0.009</td>
<td align="right">False positive: 0.99 x 0.1 = 0.099</td>
</tr>
<tr class="even">
<td align="left">Negative</td>
<td align="center">False negative: 0.01 x 0.1 = 0.001</td>
<td align="right">True negative: 0.99 x 0.9 = 0.891</td>
</tr>
</tbody>
</table>
<p>Once we have calculated the probability for each combination, we can
use the probability values to calculate the probability we want: the
probability of having cancer given a positive test result. We can do
this by dividing the probability of a true positive result (probability
of having cancer and getting a positive result = 0.009) by the total
probability of getting a positive result (0.009 probability of a true
positive plus 0.099 probability of a false positive):</p>
<p><span class="math display">\[
P(\text{Cancer|Positive}) = \frac{0.009}{0.009+0.099} = 0.083,
\]</span> This method gives us the same probability that we got using
the method above.</p>
</div>
<div id="option-3-bayes-theorem" class="section level4">
<h4>Option 3: Bayes Theorem</h4>
<p>The final method is the most formal method. It uses a formula known
as Bayes Theorem for calculating conditional probability. The theorem is
as follows:</p>
<p><span class="math display">\[
P(A|B) = \frac{P(B|A) \times P(A)}{P(B)}
\]</span> In this formula, <span class="math inline">\(P(A|B)\)</span>
is the probability that event A occurs given that event B has occurred,
<span class="math inline">\(P(B|A)\)</span> is the probability that
event B occurs given that event A has occurred, and <span
class="math inline">\(P(A)\)</span> and <span
class="math inline">\(P(B)\)</span> are the total probabilities that
events A and B occur, respectively.</p>
<p>Putting these terms in the context of our question, <span
class="math inline">\(P(A|B)\)</span> is the probability of having
cancer given a positive test result, <span
class="math inline">\(P(B|A)\)</span> is the probability of a positive
test result given a woman has cancer, <span
class="math inline">\(P(A)\)</span> is probability of having cancer, and
<span class="math inline">\(P(B)\)</span> is the total probability of a
positive test result.</p>
<p>Filling in the values for <span class="math inline">\(P(B|A)\)</span>
and <span class="math inline">\(P(A)\)</span> is easy because we are
given that information in the question. If a woman has cancer, there is
a 90% chance (0.9 probability) of getting a positive test result, so
that is the value of <span class="math inline">\(P(B|A)\)</span>. The
chance that a woman in this age group has cancer is 1% (0.01
probability), so that is the values of <span
class="math inline">\(P(A)\)</span>.</p>
<p>Calculating the value of <span class="math inline">\(P(B)\)</span> is
more involved because we have to account for two ways of getting
positive test result: having cancer and getting a positive result or not
having cancer and getting a positive result. We can use the
multiplication rule to get both of those values and then add the results
together. The probability of having cancer and getting a positive result
is the probability of having cancer multiplied by the probability of
getting a positive result if you have cancer:</p>
<p><span class="math display">\[
P(\text{Cancer and Positive} = 0.01 \times 0.9) = 0.009
\]</span> The probability of not having cancer and getting a positive
result is the probability of not having cancer multiplied by the
probability of getting a positive result if you do not have cancer:</p>
<p><span class="math display">\[
P(\text{No cancer and Positive} = 0.99 \times 0.1) = 0.099
\]</span> If we add those two values together, we get 0.108.</p>
<p>We can now fill all of our values into Bayes Theorem:</p>
<p><span class="math display">\[
P(Cancer|Positive) = \frac{0.9 \times 0.01}{0.108} = 0.083
\]</span> Once again, we get the same probability, showing that all of
these methods get us to the same result. You are welcome to choose
whichever strategy that you prefer for solving problems like this.
Personally, I often use two of the methods to double-check my work.</p>
</div>
<div id="applications-of-conditional-probability-in-statistics"
class="section level4">
<h4>Applications of conditional probability in statistics</h4>
<p>Aside from its uses in calculating probability questions like the
example above, conditional probability plays an important role in the
approaches we use for hypothesis testing. As I mentioned at the start,
when we looked at the probabilities in our hypothesis testing examples,
those were conditional probabilities. They were the probabilities of
observing a particular outcome in our data, given a particular
hypothesis. In classical frequentist statistics, we calculate the
probability of our observed outcome or a more extreme outcome, given the
null hypothesis being true. If that probability is low, we reject the
null hypothesis. In information criterion approaches, we calculate the
likelihood values for every hypothesis we are considering, which the the
probability of observed the exact outcome in our data, assuming a
particular hypothesis is true. In both of these approaches, in one way
or another, we are calculating the probability of our data given a
hypothesis: <span class="math inline">\(P(Data|Hypothesis)\)</span>.</p>
<p>In Bayesian statistics, the third approach for drawing conclusions
about our hypothesis, we calculate the probability the other way around,
the probability of a hypothesis given our data: <span
class="math inline">\(P(Hypothesis|Data)\)</span>. This is more
intuitive in terms of the conclusions we want to draw, but more
computationally challenging. The premise behind the computation, though,
is the conditional probability formula, Bayes Theorem, that is described
above. It uses the same likelihood values used in information criterion
approaches (<span class="math inline">\(P(Data|Hypothesis)\)</span>),
the probability of a hypothesis, and the probability of the data to
calculate the probability of the hypothesis given a particular data
set.</p>
</div>
</div>
<div id="binomial-theorem" class="section level3">
<h3>Binomial Theorem</h3>
<p>When we discussed hypothesis testing, we worked with some probability
tables that showed the probability of a particular number of outcomes in
our data (number of ducks that chose green bread or number of offspring
that had the dominant trait). These probabilities were calculated with a
formula known at the binomial theorem.</p>
<p>The binomial theorem works when you are working with an experiment
that has two possible outcomes. A classic example in probability is
flipping a coin. There are two possible outcomes you can get when you
flip a coin: heads or tails. However, in ecology we work with a lot of
data like this, including but not limited to:</p>
<ul>
<li>Survival: individuals can survive or die</li>
<li>Reproduction: individuals can reproduce or not</li>
<li>Species occurrence: a species can be present or absence</li>
</ul>
<p>When we are working with data like these, we can label one outcome as
a success (e.g., surviving) and one outcome as a failure (e.g., dying).
The binomial theorem then allows us to calculate the probability of a
specific number of successes in a given number of trials, based on the
probability of success. For example we could calculate that 70 out of
100 individuals in a population survive. The number of successes in this
example would be 70 and the number of trails would be the total number
of individuals in the population: 100.</p>
<p>We‚Äôll walk through the process of calculating this probability for a
specific example, and then I will present the full formula for the
binomial theorem. Here is the question we will work with for our
example: The probability of survival for a species is 0.6. If we have 3
individuals of that species, what is the probability that exactly 2 will
survive. In this example, we have 3 trials (the total number of
individuals), we want to know the probability of exactly 2 successes
(survival), and the probability of success is 0.6.</p>
<p>To start, let‚Äôs calculate the probability that the first two
individuals survive and the third individual dies. We can do this using
the multiplication rule because we want to know the probability that
individual 1 survives AND individual 2 survives AND individuals 3 dies.
We can calculate that by multiplying together those three probabilities,
remember that the probability of survival is 0.6, so the probability of
dying is 0.4:</p>
<p><span class="math display">\[
P(\text{2 survive, 1 dies}) = 0.6 \times 0.6 \times 0.4 = 0.144
\]</span> This gives us a probability of 0.144 for one way that we could
get 2 survivors out of our three individuals. This is not our final
answer, though, because there are other ways that exactly 2 of the three
individuals survive: individuals two and three could survive while
individual one dies, or individuals 1 and 3 could survive while
individual two dies. In total, there are three possible ways that two
individuals survive and the other dies, so what we ultimately want to
calculate is the probability that we get any one of these three
outcomes. We can use the addition rule to get that probability:</p>
<p><span class="math display">\[
P(\text{2 survive, 1 dies}) = 0.144 + 0.144 + 0.144 = 3 \times 0.144 =
0.432
\]</span> Therefore our total probability that exactly 2 of the three
individuals survive is 0.432.</p>
<p>This also leads us to an overall framework for approaching problems
like these. To calculate the probability of a specific number of
successes, we start by multiplying the probability of that number of
successes by the probability that the remaining trials are failures.
Then we multiply that probability by the number of combinations that
will give us the correct number of successes and failures. We have
general formulas we can use for each of these terms.</p>
<div id="probability-of-x-number-of-successes" class="section level4">
<h4>Probability of <span class="math inline">\(x\)</span> number of
successes:</h4>
<p>If we want to know the probability of <span
class="math inline">\(x\)</span> number of successes (assuming the
probability of success is the same for all trials), we calculate that as
follows:</p>
<p><span class="math display">\[
P(\text {x successes}) = p^x ,
\]</span> where <span class="math inline">\(p\)</span> is the
probability of success. In our example, <span
class="math inline">\(p\)</span> was 0.6 and <span
class="math inline">\(x\)</span> was two, so the probability of two
successes was</p>
<p><span class="math display">\[
0.6^2 = 0.6 \times 0.6 = 0.36
\]</span></p>
</div>
<div id="probability-of-failures" class="section level4">
<h4>Probability of failures:</h4>
<p>If we want to know the probability of exactly <span
class="math inline">\(x\)</span> successes in a certain number of trials
(we‚Äôll call the number of trials <span
class="math inline">\(n\)</span>), that assumes the remaining trials
must result in failures, so we want the know the probability of <span
class="math inline">\(n-x\)</span> failures. We calculate that as:</p>
<p><span class="math display">\[
P(n-x \text { failures}) = q^{n-x} ,
\]</span> where <span class="math inline">\(q\)</span> is the
probability of failure In our example, <span
class="math inline">\(q\)</span> was 0.4 and <span
class="math inline">\(n-x\)</span> was one, so the probability of two
successes was</p>
<p><span class="math display">\[
0.4^1 = 0.4
\]</span></p>
</div>
<div id="number-of-combinations" class="section level4">
<h4>Number of combinations:</h4>
<p>When we worked through the number of combinations that would give us
2 survivors in 3 individuals, we just manually listed the number of
combinations. That is doable when we only have a few trials, but it
quickly become unwieldy as we increase the number of trials. Luckily
there is a formula we can use as a shortcut for calculating the number
of ways to get <span class="math inline">\(x\)</span> successes in <span
class="math inline">\(n\)</span> trials:</p>
<p><span class="math display">\[
\frac{n!}{x!(n-x)!}
\]</span> If you fill in the values of <span
class="math inline">\(n\)</span> and <span
class="math inline">\(x\)</span> in the formula, you will get the
correct number of combinations. If you are unfamiliar with the ! symbol,
that is the factorial symbol. You calculate <span
class="math inline">\(n!\)</span> as follows:</p>
<p><span class="math display">\[
ùëõ!=ùëõ\times(ùëõ‚àí1) \times (ùëõ‚àí2) \times ‚ãØ \times 1
\]</span> Scientific calculators (and R!) have built-in functions for
calculating factorials.</p>
<p>For the purposes of this class, I won‚Äôt go into the math behind this
shortcut, but if you would like to learn more, Khan Academy has a series
on calculating combinations:
<a href="https://www.khanacademy.org/math/precalculus/x9e81a4f98389efdf:prob-comb/x9e81a4f98389efdf:combinations/v/introduction-to-combinations" target="_blank" rel="noopener noreferrer">Khan
Academy Combinations series</a></p>
</div>
<div id="putting-it-all-together" class="section level4">
<h4>Putting it all together</h4>
<p>We now have all of the pieces we need for our full binomial
formula:</p>
<p><span class="math display">\[
P(x,n) = \frac{n!}{x!(n-x)!}p^{x}q^{n-x},
\]</span> where <span class="math inline">\(P(x,n)\)</span> is the
probability of x successes in n trials. The first term calculates the
number of combinations, the second calculates the probability of the
correct number of successes, and the last calculates the probability of
the correct number of failures.</p>
<p>If we fill in the formula for our example of 2 survivors in 3
individuals, with a survival probability of 0.6, it would look like
this:</p>
<p><span class="math display">\[
P(2,3) = \frac{3!}{2!(3-2)!}0.6^{2}0.4^{3-x2} = 0.432
\]</span> The trick to using this formula is correctly identifying the
values of <span class="math inline">\(n\)</span>, <span
class="math inline">\(x\)</span>, <span
class="math inline">\(p\)</span>, and <span
class="math inline">\(q\)</span>. Once we identify those values, it is
easy to fill them into the formula. Programs like R even have built-in
functions for calculating the binomial theorem, which we will work with
in class.</p>
<p>One of the most important applications of the binomial theorem in
ecology and statistics is exactly the way we used it in our hypothesis
testing examples. We can calculate the probability of a certain number
of successes in our data, based on a particular hypothesis, and use
those probabilities to draw conclusions about how well our hypotheses
match the patterns in our data.</p>
</div>
</div>
<div
id="exercises-conditional-probability-and-binomial-theorem-in-ecology"
class="section level3">
<h3>Exercises: Conditional Probability and Binomial Theorem in
Ecology</h3>
<!---LEARNR EX 4-6-->
<iframe style="margin:0 auto; min-width: 100%;" id="myIframeL3" class="interactive" src="https://rby8g8-emily-schultz.shinyapps.io/RHandbookL8_2/
" scrolling="no" frameborder="no">
</iframe>
<!---------------->
<script>
  iFrameResize({}, ".interactive");
</script>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
